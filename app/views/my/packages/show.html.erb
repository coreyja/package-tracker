<div class="Package">
  <h2 class="Package-name">
    <%= @package.name %>
  </h2>

  <h2 class="Package-status">
    <%= @package.display_status %>
  </h2>

  <h2 class="Package-estimated">
    <% if @package.estimated_delivery_date.present? %>
      <%= @package.estimated_delivery_date %>
    <% else %>
      No Estimated Delivery Date Available
    <% end %>
  </h2>

  <h3 class="Package-number">
    <%= @package.tracking_number %>
  </h3>

  <h4 class="Package-carrier">
    <%= @package.carrier %>
  </h4>

  <table class="Package-table TrackUpdateTable">
    <thead>
    <tr>
      <th>Message</th>
      <th>Status</th>
      <th>City</th>
      <th>State</th>
      <th>Zip</th>
      <th>County</th>
      <th>Updated At</th>
    </tr>
    </thead>
    <tbody>
    <%= render partial: 'tracking_update_row', as: :tracking_update, collection: @package.tracking_updates.newest_first %>
    </tbody>
  </table>

  <%= link_to 'Refresh', my_package_tracking_refresh_path(@package), method: :post %>

  <div class="Pacakge-map" id="Pacakge-map">
  </div>
  <script>
      function initMap() {
          var map = new google.maps.Map(document.getElementById('Pacakge-map'), {
              zoom: 4,
              center: <%= @package.map_data.first.to_json.html_safe %>,
              mapTypeId: 'terrain'
          });

          var trackingCoordinates = <%= @package.map_data.to_json.html_safe %>;
          var packagePath = new google.maps.Polyline({
              path: trackingCoordinates,
              geodesic: true,
              strokeColor: '#FF0000',
              strokeOpacity: 1.0,
              strokeWeight: 2
          });

          packagePath.setMap(map);
      }
  </script>
  <script async defer
          src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAPS_API_KEY'] %>&callback=initMap">
  </script>
</div>
